<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dungeon Magic: Gift of the Magi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Dungeon Magic: Gift of the Magi</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reference/definitions.html">Reference</a></li><li class="breadcrumb-item"><a href="../reference/cart_data.html">Cartridge and Emulation Binary Data</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Tutorials</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">How-To</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Fundamentals</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Reference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Definitions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/cart_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Cartridge and Emulation Binary Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utilities_and_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utilities and Resources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cartridge-and-emulation-binary-data" id="toc-cartridge-and-emulation-binary-data" class="nav-link active" data-scroll-target="#cartridge-and-emulation-binary-data">Cartridge and Emulation Binary Data</a>
  <ul class="collapse">
  <li><a href="#cart-details" id="toc-cart-details" class="nav-link" data-scroll-target="#cart-details">Cart Details</a>
  <ul class="collapse">
  <li><a href="#rom" id="toc-rom" class="nav-link" data-scroll-target="#rom">ROM</a></li>
  <li><a href="#circuit-board" id="toc-circuit-board" class="nav-link" data-scroll-target="#circuit-board">Circuit Board</a></li>
  <li><a href="#chip-info" id="toc-chip-info" class="nav-link" data-scroll-target="#chip-info">Chip Info</a></li>
  </ul></li>
  <li><a href="#emulation-binary" id="toc-emulation-binary" class="nav-link" data-scroll-target="#emulation-binary">Emulation Binary</a>
  <ul class="collapse">
  <li><a href="#the-.nes-binary-file" id="toc-the-.nes-binary-file" class="nav-link" data-scroll-target="#the-.nes-binary-file">The .NES Binary File</a></li>
  </ul></li>
  <li><a href="#the-rom-header" id="toc-the-rom-header" class="nav-link" data-scroll-target="#the-rom-header">The ROM Header</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="cartridge-and-emulation-binary-data" class="level1">
<h1>Cartridge and Emulation Binary Data</h1>
<p>This data was distilled from <a href="https://nescartdb.com/profile/view/1100/wizardry-proving-grounds-of-the-mad-overlord">nescartdb</a>, an excellent cart resource.</p>
<p><strong>Note</strong>: I’m unsure what parts of this will be useful. We’ll see.</p>
<section id="cart-details" class="level2">
<h2 class="anchored" data-anchor-id="cart-details">Cart Details</h2>
<ul>
<li>Released in USA in 1990 (in Japan in 1989).</li>
</ul>
<section id="rom" class="level3">
<h3 class="anchored" data-anchor-id="rom">ROM</h3>
<ul>
<li>PRG0 (NES-09-0 PRG) 128 KB</li>
<li>CHR0 (NES-09-O CHR) 128 KB</li>
</ul>
</section>
<section id="circuit-board" class="level3">
<h3 class="anchored" data-anchor-id="circuit-board">Circuit Board</h3>
<p>This may be less important but useful for searching.</p>
<ul>
<li>NES-SKROM-04 (Nintendo Produced, November 1990 First Run).</li>
<li>iNES Mapper: 1 (???)</li>
<li>Mirroring: Mapper Ctrl</li>
<li>Battery: Yes</li>
<li>WRAM: 8 KB</li>
<li>VRAM: 0 KB</li>
</ul>
</section>
<section id="chip-info" class="level3">
<h3 class="anchored" data-anchor-id="chip-info">Chip Info</h3>
<ul>
<li>U1 PRG (NEC) Mask ROM 128 KB (200 ns)</li>
<li>U2 CHR (NEC) Mask ROM 128 KB (200 ns)</li>
<li>U3 CIC</li>
<li>U4 MMC1 (NEC) MMC1B2</li>
</ul>
</section>
</section>
<section id="emulation-binary" class="level2">
<h2 class="anchored" data-anchor-id="emulation-binary">Emulation Binary</h2>
<section id="the-.nes-binary-file" class="level3">
<h3 class="anchored" data-anchor-id="the-.nes-binary-file">The .NES Binary File</h3>
<p>The file we will be using is <code>Dungeon Magic - Sword of the Elements (USA).nes</code>. <strong>Going forward, we will refer to this file as the “ROM”.</strong></p>
<p>To check that the file is correct, run the following checksum calculation commands in terminal (using the actual path instead of <code>/location/of/rom.nes</code> when using the commands):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource shell number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a># MD5 Checksum.</span>
<span id="cb1-2"><a href="#cb1-2"></a>&gt; md5sum /location/of/rom.nes</span>
<span id="cb1-3"><a href="#cb1-3"></a>90c6e21b079795f5c9905142f34c56b6</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a># SHA1 Checksum.</span>
<span id="cb1-6"><a href="#cb1-6"></a>&gt; sha1sum /location/of/rom.nes</span>
<span id="cb1-7"><a href="#cb1-7"></a>0f8e5f97e23f1209f08cbd27c1c58ea585f0c3b1</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a># CRC32 Checksum.  </span>
<span id="cb1-10"><a href="#cb1-10"></a># On Debian, may need to be installed.</span>
<span id="cb1-11"><a href="#cb1-11"></a>&gt; crc32 /location/of/rom.nes</span>
<span id="cb1-12"><a href="#cb1-12"></a>1fedecae</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(Note that <em>we cannot help you find this ROM</em>, but searching for the exact name above could be a good start.)</p>
</section>
</section>
<section id="the-rom-header" class="level2">
<h2 class="anchored" data-anchor-id="the-rom-header">The ROM Header</h2>
<p>The ROM header will let us see what kind of file format this is (<a href="https://www.nesdev.org/wiki/INES#iNES_file_format">iNES</a> vs.&nbsp;<a href="https://www.nesdev.org/wiki/NES_2.0">NES 2.0</a>). This will be important as we need to know the structure of the ROM to hack at it. We will find out in a bit that that this ROM <em>will be in the NES 2.0 format</em> so we will ignore the iNES format in what follows.</p>
<p>To inspect the ROM file’s values we can use any hex editor: <a href="https://tasvideos.org/Bizhawk">Bizhawk</a> comes with one, or <a href="https://github.com/WerWolv/ImHex">ImHex</a> is a great choice for a stand-alone hex editor.</p>
<p>The 16 byte header of this ROM file (from 00 to 0F) is:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource text number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a>4E 45 53 1A 08 10 12 08 00 00 70 00 00 00 00 01</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Corresponding to the following (with much more information <a href="https://www.nesdev.org/wiki/NES_2.0#File_Structure">here</a>):</p>
<table class="table">
<thead>
<tr class="header">
<th>Byte</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00</td>
<td>4E</td>
<td>ASCII “N”</td>
</tr>
<tr class="even">
<td>01</td>
<td>45</td>
<td>ASCII “E”</td>
</tr>
<tr class="odd">
<td>02</td>
<td>53</td>
<td>ASCII “S”</td>
</tr>
<tr class="even">
<td>03</td>
<td>1A</td>
<td>ASCII SUB / MS-DOS EOF<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></td>
</tr>
<tr class="odd">
<td>04</td>
<td><span class="math inline">\(hex(08) = 8\)</span></td>
<td>Least Significant Bit of PRG-ROM.</td>
</tr>
<tr class="even">
<td>05</td>
<td><span class="math inline">\(hex(10) = 16\)</span></td>
<td>Least Significant Bit of CHR-ROM.</td>
</tr>
<tr class="odd">
<td>06</td>
<td><span class="math inline">\(hex(12) = 18 = bin(00010010)\)</span></td>
<td>Flags. See Below.</td>
</tr>
<tr class="even">
<td>07</td>
<td><span class="math inline">\(hex(08) = 8 = bin(00001010)\)</span></td>
<td>Flags. See Below.</td>
</tr>
<tr class="odd">
<td>08</td>
<td>0</td>
<td>Most Significant Bit of Mapper.</td>
</tr>
<tr class="even">
<td>09</td>
<td>0</td>
<td>Most Significant Bit of PRG-ROM/CHR-ROM.</td>
</tr>
<tr class="odd">
<td>0A</td>
<td><span class="math inline">\(hex(70) = 112 = bin(01110000)\)</span></td>
<td>PRG-RAM size — in a weird way.</td>
</tr>
<tr class="even">
<td>0B</td>
<td>0</td>
<td>CHR-RAM size. (Seems to say: no CHR-RAM.)</td>
</tr>
<tr class="odd">
<td>0C</td>
<td>0</td>
<td>CPU/PPU Timing flag. (“NTSC NES”)</td>
</tr>
<tr class="even">
<td>0D</td>
<td>0</td>
<td>(We don’t care about this one.)</td>
</tr>
<tr class="odd">
<td>0E</td>
<td>0</td>
<td>(We don’t care about this one.)</td>
</tr>
<tr class="even">
<td>0F</td>
<td><span class="math inline">\(hex(01) = 1\)</span></td>
<td>Uses Standard NES controllers.</td>
</tr>
</tbody>
</table>
<p>Some things to take away from this:</p>
<ul>
<li><p>For PRG-ROM there are 8 ($04) chunks of 16KiB each. (<strong>QUESTIONS: WHERE DOES THE 8KiB COME FROM?</strong>)</p></li>
<li><p>FOR CHR-ROM there are 16 ($05) chunks of 8KiB each. (<strong>QUESTIONS: WHERE DOES THE 8KiB COME FROM?</strong>)</p></li>
<li><p>Note the address $06 above. Check this flag out here<a href="https://www.nesdev.org/wiki/NES_2.0#File_Structure">here</a>, which we reproduce below for convenience. The binary is <span class="math inline">\(00010010\)</span> which gives us: “Mapper Number D0” (<strong>QUESTION: WHAT IS THIS</strong>), “Mirrored Horizontally”, and “Battery” is present. Indeed, there was a battery with this game.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource text number-lines code-with-copy"><code class="sourceCode"><span id="cb3-1"><a href="#cb3-1"></a># FLAG $06</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>D~7654 3210</span>
<span id="cb3-4"><a href="#cb3-4"></a>  ---------</span>
<span id="cb3-5"><a href="#cb3-5"></a>  NNNN FTBM</span>
<span id="cb3-6"><a href="#cb3-6"></a>  |||| |||+-- Hard-wired nametable layout</span>
<span id="cb3-7"><a href="#cb3-7"></a>  |||| |||     0: Vertical arrangement ("mirrored horizontally") or mapper-controlled</span>
<span id="cb3-8"><a href="#cb3-8"></a>  |||| |||     1: Horizontal arrangement ("mirrored vertically")</span>
<span id="cb3-9"><a href="#cb3-9"></a>  |||| ||+--- "Battery" and other non-volatile memory</span>
<span id="cb3-10"><a href="#cb3-10"></a>  |||| ||      0: Not present</span>
<span id="cb3-11"><a href="#cb3-11"></a>  |||| ||      1: Present</span>
<span id="cb3-12"><a href="#cb3-12"></a>  |||| |+--- 512-byte Trainer</span>
<span id="cb3-13"><a href="#cb3-13"></a>  |||| |      0: Not present</span>
<span id="cb3-14"><a href="#cb3-14"></a>  |||| |      1: Present between Header and PRG-ROM data</span>
<span id="cb3-15"><a href="#cb3-15"></a>  |||| +---- Alternative nametables</span>
<span id="cb3-16"><a href="#cb3-16"></a>  ||||        0: No</span>
<span id="cb3-17"><a href="#cb3-17"></a>  ||||        1: Yes</span>
<span id="cb3-18"><a href="#cb3-18"></a>  ++++------ Mapper Number D3..D0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Similarly, for $07, we have the binary value <span class="math inline">\(00001010\)</span>. The flag map is reproduced below from the same resource as above. Given this, we know that the console was the NES (as expected) and that, indeed, this is an NES 2.0 Heading. This is how we knew the game was in the NES 2.0 Format.</li>
<li>Remember the 512-byte trainer is <em>not present</em>. We will need this soon.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource text number-lines code-with-copy"><code class="sourceCode"><span id="cb4-1"><a href="#cb4-1"></a># FLAG $07</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>D~7654 3210</span>
<span id="cb4-4"><a href="#cb4-4"></a>  ---------</span>
<span id="cb4-5"><a href="#cb4-5"></a>  NNNN 10TT</span>
<span id="cb4-6"><a href="#cb4-6"></a>  |||| ||++- Console type</span>
<span id="cb4-7"><a href="#cb4-7"></a>  |||| ||     0: Nintendo Entertainment System/Family Computer</span>
<span id="cb4-8"><a href="#cb4-8"></a>  |||| ||     1: Nintendo Vs. System</span>
<span id="cb4-9"><a href="#cb4-9"></a>  |||| ||     2: Nintendo Playchoice 10</span>
<span id="cb4-10"><a href="#cb4-10"></a>  |||| ||     3: Extended Console Type</span>
<span id="cb4-11"><a href="#cb4-11"></a>  |||| ++--- NES 2.0 identifier</span>
<span id="cb4-12"><a href="#cb4-12"></a>  ++++------ Mapper Number D7..D4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The other values may come up later but, for now, this seems reasonable and gives us enough to be confident about diving into the cart.</li>
</ul>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://en.wikipedia.org/wiki/Substitute_character#End_of_file">SUB as MS-DOS End of File</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>